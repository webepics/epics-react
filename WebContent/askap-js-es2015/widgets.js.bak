import ToggleButton from 'react-toggle-button'

const borderRadiusStyle = { borderRadius: 2 }
<ToggleButton
    value={ self.state.value || false }
    thumbStyle={borderRadiusStyle}
    trackStyle={borderRadiusStyle}
    onToggle={(value) => {
        self.setState({
        value: !value,
    })
}} />


class BaseWidget extends React.Component {

	constructor() {
		super();
	}

	componentWillMount() {
		this.subId = wsManager.subscribe(this.props.pv, (message)=>this.processUpdate(message));
	}

	componentWillUnmount() {
		wsManager.unsubscriber(this.subId);
	}
}



class LED extends BaseWidget {

	constructor() {
		super();
		this.state = {currentValue: "led-yellow"};
	}

	processUpdate(message) {
		if (message.type == 'connection') {
			if (message.connected)
				this.setState({currentValue: "led-blue"});
			
			return;
		}
		
		if (message.type == 'value') {			
			if (message.value.value == 0)
				this.setState({currentValue: "led-red"});
			else if (message.value.value == 1)
				this.setState({currentValue: "led-green"});
			else
				this.setState({currentValue: "led-blue"});
		}
	}

	render() {
        return (
			<div className={this.state.currentValue}></div>
        );
	}
}

class TextWidget extends BaseWidget {

	constructor() {
		super();
		this.state = {currentValue: ""};
	}

	processUpdate(message) {
		if (message.type == 'value')
			this.setState({currentValue: message.value.value});
	}

	render() {
	    return (
		    <div>
		      <label className='col-md-6'>{this.props.label}</label>
		      <input type="text" className='col-md-6' value={this.state.currentValue}/>
		  	</div>
	    );
	}
}

class Combined extends React.Component {
	render() {
		return (
			<div>
				<div className='col-md-6'>
					<TextWidget label="My label:" pv="xwu90:adx:c01:bul:fpga:temp" />
				</div>
				<div className='col-md-6'>
					<LED pv="xwu90:adx:F_startup:center_O" />
				</div>
					<ToggleButton
				        value={ self.state.value || false }
				        thumbStyle={borderRadiusStyle}
				        trackStyle={borderRadiusStyle}
				        onToggle={(value) => {
				            self.setState({
				            value: !value,
				        })
				    }} />					
			  </div>
		)
	}
}

jQuery(function() {
	  ReactDOM.render(
		  <Combined />,
		  document.getElementById('test')
	  );
})
